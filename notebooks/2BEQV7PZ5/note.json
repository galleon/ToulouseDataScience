{
  "paragraphs": [
    {
      "text": "%md\n\nWe have launched this Zeppelin instance with [Docker](https://www.docker.com/) and [Docker Compose](https://www.docker.com/products/docker-compose) to volume-mount the local `./data`  and `./notebooks` directories local to your project.",
      "dateUpdated": "Jun 25, 2016 7:03:16 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/markdown",
        "editorHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1459602416740_-108193700",
      "id": "20160402-130656_696270436",
      "result": {
        "code": "SUCCESS",
        "type": "HTML",
        "msg": "\u003cp\u003eWe have launched this Zeppelin instance with \u003ca href\u003d\"https://www.docker.com/\"\u003eDocker\u003c/a\u003e and \u003ca href\u003d\"https://www.docker.com/products/docker-compose\"\u003eDocker Compose\u003c/a\u003e to volume-mount the local \u003ccode\u003e./data\u003c/code\u003e  and \u003ccode\u003e./notebooks\u003c/code\u003e directories local to your project.\u003c/p\u003e\n"
      },
      "dateCreated": "Apr 2, 2016 1:06:56 PM",
      "dateStarted": "Jun 25, 2016 7:03:14 AM",
      "dateFinished": "Jun 25, 2016 7:03:14 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sh\n\nwget https://raw.githubusercontent.com/caroljmcdonald/sparkmldecisiontree/master/data/rita2014jan.csv -O data/rita2014jan.csv.new\n#unzip rita2014jan.csv.zip",
      "dateUpdated": "Jun 25, 2016 9:09:24 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/sh"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1459602490325_842828960",
      "id": "20160402-130810_963581603",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": ""
      },
      "dateCreated": "Apr 2, 2016 1:08:10 PM",
      "dateStarted": "Jun 25, 2016 9:09:24 PM",
      "dateFinished": "Jun 25, 2016 9:09:51 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Let\u0027s import what is needed to solve our problem",
      "text": "%spark\nimport scala.util.Try\n\nimport org.apache.spark._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.tree.DecisionTree\nimport org.apache.spark.mllib.tree.model.DecisionTreeModel\nimport org.apache.spark.mllib.util.MLUtils\n",
      "dateUpdated": "Jun 25, 2016 8:29:47 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "editorHide": true,
        "tableHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466838995222_-738388382",
      "id": "20160625-071635_661782475",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "import scala.util.Try\nimport org.apache.spark._\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.mllib.regression.LabeledPoint\nimport org.apache.spark.mllib.linalg.Vectors\nimport org.apache.spark.mllib.tree.DecisionTree\nimport org.apache.spark.mllib.tree.model.DecisionTreeModel\nimport org.apache.spark.mllib.util.MLUtils\n"
      },
      "dateCreated": "Jun 25, 2016 7:16:35 AM",
      "dateStarted": "Jun 25, 2016 8:18:08 AM",
      "dateFinished": "Jun 25, 2016 8:18:11 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Define the Flight class",
      "text": "// define the Flight Schema\ncase class Flight(dofM: String, dofW: String, carrier: String, tailnum: String, flnum: Int, org_id: String,\n                      origin: String, dest_id: String, dest: String, crsdeptime: Double, deptime: Double, depdelaymins: Double,\n                      crsarrtime: Double, arrtime: Double, arrdelay: Double, crselapsedtime: Double, dist: Int)",
      "dateUpdated": "Jun 25, 2016 8:44:02 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "lineNumbers": true,
        "title": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466841905255_295981938",
      "id": "20160625-080505_901112752",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "defined class Flight\n"
      },
      "dateCreated": "Jun 25, 2016 8:05:05 AM",
      "dateStarted": "Jun 25, 2016 8:06:23 AM",
      "dateFinished": "Jun 25, 2016 8:06:25 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "def parseFlight(str: String): Flight \u003d {\n    val line \u003d str.split(\",\")\n    Flight(line(0)          , line(1)          , line(2)          , line(3)          , line(4).toInt    ,\n           line(5)          , line(6)          , line(7)          , line(8)          , line(9).toDouble , \n           line(10).toDouble, line(11).toDouble, line(12).toDouble, line(13).toDouble, line(14).toDouble, \n           line(15).toDouble, line(16).toInt)\n}",
      "dateUpdated": "Jun 25, 2016 8:56:54 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466841982937_-619446254",
      "id": "20160625-080622_562461891",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "parseFlight: (str: String)Flight\n"
      },
      "dateCreated": "Jun 25, 2016 8:06:22 AM",
      "dateStarted": "Jun 25, 2016 8:56:54 PM",
      "dateFinished": "Jun 25, 2016 8:56:55 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Try to read all the lines from the CSV file",
      "text": "val linesCnt \u003d sc.accumulator(0L, \"total lines\")\nval flightsRDD \u003d sc.textFile(\"data/rita2014jan.csv\")\n      .flatMap { line \u003d\u003e\n        linesCnt +\u003d 1\n        Try { parseFlight(line) }.toOption\n      }.cache()\nflightsRDD.toDF().registerTempTable(\"flightsRDD\")",
      "dateUpdated": "Jun 26, 2016 6:59:39 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "title": true,
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466842137972_1837422305",
      "id": "20160625-080857_1510863370",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "linesCnt: org.apache.spark.Accumulator[Long] \u003d 0\nflightsRDD: org.apache.spark.rdd.RDD[Flight] \u003d MapPartitionsRDD[75] at flatMap at \u003cconsole\u003e:55\n"
      },
      "dateCreated": "Jun 25, 2016 8:08:57 AM",
      "dateStarted": "Jun 26, 2016 6:59:40 AM",
      "dateFinished": "Jun 26, 2016 6:59:44 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Show the number of useful lines ",
      "text": "// use .count to trigger the computation and tick the counters\nval validCnt \u003d flightsRDD.count()\nval badCnt \u003d linesCnt.value - validCnt\nprintln(s\"$badCnt ${\"%.4f\".format(badCnt / linesCnt.value.toDouble * 100)}% bad lines out of ${linesCnt.value} total.\")",
      "dateUpdated": "Jun 25, 2016 8:58:59 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466842615310_515871653",
      "id": "20160625-081655_990865602",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "validCnt: Long \u003d 439620\nbadCnt: Long \u003d 2002\n2002 0.4533% bad lines out of 441622 total.\n"
      },
      "dateCreated": "Jun 25, 2016 8:16:55 AM",
      "dateStarted": "Jun 25, 2016 8:57:06 PM",
      "dateFinished": "Jun 25, 2016 8:57:12 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql\n\nselect dofW, case when depdelaymins \u003e 15 then  \u0027delayed\u0027 else \u0027ok\u0027 end, count(1)\nfrom flightsRDD\ngroup by dofW, case when depdelaymins \u003e 15 then  \u0027delayed\u0027 else \u0027ok\u0027 end\n",
      "dateUpdated": "Jun 26, 2016 7:02:04 AM",
      "config": {
        "colWidth": 6.0,
        "graph": {
          "mode": "multiBarChart",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "dofW",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "_c2",
              "index": 2.0,
              "aggr": "sum"
            }
          ],
          "groups": [
            {
              "name": "_c1",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "scatter": {
            "xAxis": {
              "name": "dofW",
              "index": 0.0,
              "aggr": "sum"
            },
            "yAxis": {
              "name": "_c1",
              "index": 1.0,
              "aggr": "sum"
            }
          }
        },
        "enabled": true,
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466888351440_-2147172604",
      "id": "20160625-205911_634623471",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "dofW\t_c1\t_c2\n4\tdelayed\t22115\n4\tok\t53727\n5\tdelayed\t21321\n5\tok\t54537\n6\tdelayed\t13449\n1\tdelayed\t13639\n6\tok\t35345\n7\tdelayed\t13156\n1\tok\t45995\n2\tdelayed\t11730\n7\tok\t42980\n2\tok\t41132\n3\tdelayed\t18112\n3\tok\t52382\n"
      },
      "dateCreated": "Jun 25, 2016 8:59:11 PM",
      "dateStarted": "Jun 26, 2016 6:59:51 AM",
      "dateFinished": "Jun 26, 2016 7:00:05 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%sql \n\nselect cast(cast(crsdeptime as int)/100 as int) as hour, case when depdelaymins \u003e 15 then  \u0027delayed\u0027 else \u0027ok\u0027 end as delay, count(1) as count from flightsRDD\ngroup by cast(cast(crsdeptime as int)/100 as int), case when depdelaymins \u003e 15 then  \u0027delayed\u0027 else \u0027ok\u0027 end",
      "dateUpdated": "Jun 26, 2016 7:22:37 AM",
      "config": {
        "colWidth": 6.0,
        "graph": {
          "mode": "multiBarChart",
          "height": 300.0,
          "optionOpen": false,
          "keys": [
            {
              "name": "hour",
              "index": 0.0,
              "aggr": "sum"
            }
          ],
          "values": [
            {
              "name": "count",
              "index": 2.0,
              "aggr": "sum"
            }
          ],
          "groups": [
            {
              "name": "delay",
              "index": 1.0,
              "aggr": "sum"
            }
          ],
          "scatter": {
            "yAxis": {
              "name": "delay",
              "index": 1.0,
              "aggr": "sum"
            },
            "xAxis": {
              "name": "hour",
              "index": 0.0,
              "aggr": "sum"
            }
          },
          "lineWithFocus": true
        },
        "enabled": true,
        "editorMode": "ace/mode/sql"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466924544209_-1803973664",
      "id": "20160626-070224_1809973994",
      "result": {
        "code": "SUCCESS",
        "type": "TABLE",
        "msg": "hour\tdelay\tcount\n18\tdelayed\t8871\n12\tok\t20645\n2\tdelayed\t17\n23\tok\t1742\n13\tdelayed\t8438\n7\tok\t26280\n18\tok\t16055\n8\tdelayed\t5097\n2\tok\t59\n19\tdelayed\t9055\n13\tok\t20972\n3\tdelayed\t3\n14\tdelayed\t8786\n8\tok\t27140\n19\tok\t15987\n9\tdelayed\t5196\n3\tok\t2\n20\tdelayed\t6176\n14\tok\t19582\n4\tdelayed\t15\n15\tdelayed\t8553\n9\tok\t21969\n20\tok\t10787\n10\tdelayed\t6545\n4\tok\t52\n21\tdelayed\t3756\n15\tok\t18840\n5\tdelayed\t481\n16\tdelayed\t9117\n10\tok\t22081\n0\tdelayed\t82\n21\tok\t7284\n11\tdelayed\t7343\n5\tok\t4299\n22\tdelayed\t1228\n16\tok\t18078\n6\tdelayed\t2597\n0\tok\t527\n17\tdelayed\t10546\n11\tok\t22352\n1\tdelayed\t29\n22\tok\t4410\n12\tdelayed\t7576\n6\tok\t24927\n23\tdelayed\t490\n17\tok\t21838\n7\tdelayed\t3525\n1\tok\t190\n"
      },
      "dateCreated": "Jun 26, 2016 7:02:24 AM",
      "dateStarted": "Jun 26, 2016 7:21:05 AM",
      "dateFinished": "Jun 26, 2016 7:21:07 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "title": "Transform non-numeric data into numeric values",
      "text": "\nval carrierMap: Map[String, Int] \u003d flightsRDD.map(_.carrier).distinct.collect().zipWithIndex.toMap\n\nval originMap: Map[String, Int] \u003d flightsRDD.map(_.origin).distinct.collect.zipWithIndex.toMap\n\nval destMap: Map[String, Int] \u003d flightsRDD.map(_.dest).distinct.collect.zipWithIndex.toMap",
      "dateUpdated": "Jun 25, 2016 9:01:14 PM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala",
        "tableHide": true,
        "title": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466842741433_1386158341",
      "id": "20160625-081901_1918890228",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "carrierMap: Map[String,Int] \u003d Map(DL -\u003e 5, F9 -\u003e 10, US -\u003e 9, OO -\u003e 2, B6 -\u003e 0, AA -\u003e 6, EV -\u003e 12, FL -\u003e 1, UA -\u003e 4, MQ -\u003e 8, WN -\u003e 13, AS -\u003e 3, VX -\u003e 7, HA -\u003e 11)\noriginMap: Map[String,Int] \u003d Map(ROW -\u003e 23, OAJ -\u003e 144, GCC -\u003e 232, SYR -\u003e 80, TYR -\u003e 162, TUL -\u003e 180, STL -\u003e 203, IDA -\u003e 61, ICT -\u003e 62, MQT -\u003e 37, SWF -\u003e 118, EKO -\u003e 148, JFK -\u003e 216, LGB -\u003e 241, ISP -\u003e 101, ART -\u003e 288, ORD -\u003e 234, STX -\u003e 170, EGE -\u003e 159, LWS -\u003e 132, TWF -\u003e 229, LAS -\u003e 44, BET -\u003e 286, GSP -\u003e 117, DAY -\u003e 123, KOA -\u003e 252, BUR -\u003e 292, DRO -\u003e 276, PVD -\u003e 31, BRD -\u003e 77, SPS -\u003e 1, CLD -\u003e 184, SGF -\u003e 86, CDV -\u003e 222, STT -\u003e 214, OTZ -\u003e 279, AVL -\u003e 199, BOI -\u003e 12, PSP -\u003e 150, SAF -\u003e 40, FWA -\u003e 146, MHT -\u003e 186, SBN -\u003e 206, RDM -\u003e 182, PSG -\u003e 59, LAX -\u003e 294, BQN -\u003e 293, HSV -\u003e 257, RIC -\u003e 6, BTM -\u003e 217, LSE -\u003e 33, FCA -\u003e 55, JAC -\u003e 110, ATL -\u003e 273, CHA -\u003e 112, BQK -\u003e 96, MIA -\u003e 176, GUC -\u003e 282, SBP -\u003e 163, BFL -\u003e 74, DHN -\u003e 51, FLG -\u003e 155, BRO -\u003e 274, LAN -\u003e 192, FSM -\u003e 15, RAP -\u003e...destMap: Map[String,Int] \u003d Map(ROW -\u003e 23, OAJ -\u003e 144, GCC -\u003e 232, SYR -\u003e 80, TYR -\u003e 162, TUL -\u003e 180, STL -\u003e 203, IDA -\u003e 61, ICT -\u003e 62, MQT -\u003e 37, SWF -\u003e 118, EKO -\u003e 148, JFK -\u003e 216, LGB -\u003e 241, ISP -\u003e 101, ART -\u003e 288, ORD -\u003e 234, STX -\u003e 170, EGE -\u003e 159, LWS -\u003e 132, TWF -\u003e 229, LAS -\u003e 44, BET -\u003e 286, GSP -\u003e 117, DAY -\u003e 123, KOA -\u003e 252, BUR -\u003e 292, DRO -\u003e 276, PVD -\u003e 31, BRD -\u003e 77, SPS -\u003e 1, CLD -\u003e 184, SGF -\u003e 86, CDV -\u003e 222, STT -\u003e 214, OTZ -\u003e 279, AVL -\u003e 199, BOI -\u003e 12, PSP -\u003e 150, SAF -\u003e 40, FWA -\u003e 146, MHT -\u003e 186, SBN -\u003e 206, RDM -\u003e 182, PSG -\u003e 59, LAX -\u003e 294, BQN -\u003e 293, HSV -\u003e 257, RIC -\u003e 6, BTM -\u003e 217, LSE -\u003e 33, FCA -\u003e 55, JAC -\u003e 110, ATL -\u003e 273, CHA -\u003e 112, BQK -\u003e 96, MIA -\u003e 176, GUC -\u003e 282, SBP -\u003e 163, BFL -\u003e 74, DHN -\u003e 51, FLG -\u003e 155, BRO -\u003e 274, LAN -\u003e 192, FSM -\u003e 15, RAP -\u003e 2..."
      },
      "dateCreated": "Jun 25, 2016 8:19:01 AM",
      "dateStarted": "Jun 25, 2016 9:01:14 PM",
      "dateFinished": "Jun 25, 2016 9:01:17 PM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// Define the features array as a LabeledPoint.  Select only relevant features\n\nval mldata \u003d flightsRDD.map { flight \u003d\u003e\n    LabeledPoint(\n      if (flight.depdelaymins \u003e 40) 1.0 else 0.0,\n      Vectors.dense(\n          flight.dofM.toDouble - 1,           // day of month\n          flight.dofW.toDouble - 1,           // day of week\n          flight.crsdeptime,                  // departure time\n          flight.crsarrtime,                  // arrival time\n          carrierMap(flight.carrier).toDouble,// carrier\n          flight.crselapsedtime,              // elapsed flight time\n          originMap(flight.origin).toDouble,  // departure city\n          destMap(flight.dest).toDouble       // arrival city\n      )\n    )\n}.cache()",
      "dateUpdated": "Jun 25, 2016 8:34:26 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466843535651_-700437280",
      "id": "20160625-083215_921390371",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "mldata: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d MapPartitionsRDD[15] at map at \u003cconsole\u003e:64\n"
      },
      "dateCreated": "Jun 25, 2016 8:32:15 AM",
      "dateStarted": "Jun 25, 2016 8:34:26 AM",
      "dateFinished": "Jun 25, 2016 8:34:27 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// Partition the data into training and test data sets\n\n// mldata0 is %85 not delayed flights\nval mldata0 \u003d mldata.filter(x \u003d\u003e x.label \u003d\u003d 0).randomSplit(Array(0.85, 0.15))(1)\n// mldata1 is %100 delayed flights\nval mldata1 \u003d mldata.filter(x \u003d\u003e x.label !\u003d 0)\n// mldata2 is delayed and not delayed\nval mldata2 \u003d mldata0 ++ mldata1\n\n//  split mldata2 into training and test data\nval splits \u003d mldata2.randomSplit(Array(0.7, 0.3))\nval (trainingData, testData) \u003d (splits(0), splits(1))",
      "dateUpdated": "Jun 25, 2016 8:35:42 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466843666242_1093863024",
      "id": "20160625-083426_1740387590",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "mldata0: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d MapPartitionsRDD[18] at randomSplit at \u003cconsole\u003e:67\nmldata1: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d MapPartitionsRDD[19] at filter at \u003cconsole\u003e:64\nmldata2: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d UnionRDD[20] at $plus$plus at \u003cconsole\u003e:68\nsplits: Array[org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint]] \u003d Array(MapPartitionsRDD[21] at randomSplit at \u003cconsole\u003e:70, MapPartitionsRDD[22] at randomSplit at \u003cconsole\u003e:70)\ntrainingData: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d MapPartitionsRDD[21] at randomSplit at \u003cconsole\u003e:70\ntestData: org.apache.spark.rdd.RDD[org.apache.spark.mllib.regression.LabeledPoint] \u003d MapPartitionsRDD[22] at randomSplit at \u003cconsole\u003e:70\n"
      },
      "dateCreated": "Jun 25, 2016 8:34:26 AM",
      "dateStarted": "Jun 25, 2016 8:35:42 AM",
      "dateFinished": "Jun 25, 2016 8:35:44 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "// Define some parameters and train the model.\n\n// airity of non-continuous features\nval categoricalFeaturesInfo \u003d Map(\n      0 -\u003e 31,\n      1 -\u003e 7,\n      4 -\u003e carrierMap.size,\n      6 -\u003e originMap.size,\n      7 -\u003e destMap.size\n)\n\nval numClasses \u003d 2      // 0, 1\nval impurity   \u003d \"gini\" // or \u0027entropy\u0027\nval maxDepth   \u003d 3      // 9  depth of the decision tree\nval maxBins    \u003d 500    // 7000 discretization of continuous features\n\n// call DecisionTree trainClassifier with the trainingData , which returns the model\nval model \u003d DecisionTree.trainClassifier(trainingData, numClasses, categoricalFeaturesInfo, impurity, maxDepth, maxBins)\n\nz.put(\"modelVar\", model.toDebugString)",
      "dateUpdated": "Jun 26, 2016 7:52:48 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466843742020_-1827242570",
      "id": "20160625-083542_1311752512",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "categoricalFeaturesInfo: scala.collection.immutable.Map[Int,Int] \u003d Map(0 -\u003e 31, 1 -\u003e 7, 6 -\u003e 301, 7 -\u003e 301, 4 -\u003e 14)\nnumClasses: Int \u003d 2\nimpurity: String \u003d gini\nmaxDepth: Int \u003d 3\nmaxBins: Int \u003d 500\nmodel: org.apache.spark.mllib.tree.model.DecisionTreeModel \u003d DecisionTreeModel classifier of depth 3 with 15 nodes\n"
      },
      "dateCreated": "Jun 25, 2016 8:35:42 AM",
      "dateStarted": "Jun 26, 2016 7:52:48 AM",
      "dateFinished": "Jun 26, 2016 7:52:53 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "%pyspark\n\nmodelVar \u003d z.get(\"modelVar\")\n\ndef parse(lines):\n\tblock \u003d []\n\twhile lines :\n\t\t\t\n\t\tif lines[0].startswith(\u0027If\u0027):\n\t\t\tbl \u003d \u0027 \u0027.join(lines.pop(0).split()[1:]).replace(\u0027(\u0027, \u0027\u0027).replace(\u0027)\u0027, \u0027\u0027)\n\t\t\tblock.append({\u0027name\u0027:bl, \u0027children\u0027:parse(lines)})\n\t\t\t\t\n\t\t\t\t\n\t\t\tif lines[0].startswith(\u0027Else\u0027):\n\t\t\t\tbe \u003d \u0027 \u0027.join(lines.pop(0).split()[1:]).replace(\u0027(\u0027, \u0027\u0027).replace(\u0027)\u0027, \u0027\u0027)\n\t\t\t\tblock.append({\u0027name\u0027:be, \u0027children\u0027:parse(lines)})\n\t\telif not lines[0].startswith((\u0027If\u0027,\u0027Else\u0027)):\n\t\t\tblock2 \u003d lines.pop(0)\n\t\t\tblock.append({\u0027name\u0027:block2})\n\t\telse:\n\t\t\tbreak\t\n\treturn block\n\t\n# Convert Tree to JSON\ndef tree_json(tree):\n\tdata \u003d []\n\tfor line in tree.splitlines() : \n\t\tif line.strip():\n\t\t\tline \u003d line.strip()\n\t\t\tdata.append(line)\n\t\telse : break\n\t\tif not line : break\n\tres \u003d []\n\tres.append({\u0027name\u0027:\u0027Root\u0027, \u0027children\u0027:parse(data[1:])})\n\t#with open(\u0027data/structure.json\u0027, \u0027w\u0027) as outfile:\n\t#\tjson.dump(res[0], outfile)\n\n\treturn res\n\t\t\nresult \u003d tree_json(modelVar)\n\nprint (\"transformation succesful\")",
      "dateUpdated": "Jun 26, 2016 7:54:03 AM",
      "config": {
        "colWidth": 6.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466926656155_96519505",
      "id": "20160626-073736_651859057",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "transformation succesful\n"
      },
      "dateCreated": "Jun 26, 2016 7:37:36 AM",
      "dateStarted": "Jun 26, 2016 7:52:58 AM",
      "dateFinished": "Jun 26, 2016 7:52:58 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "text": "\n// Evaluate model on test instances and compute test error\n\nval obsCnt \u003d sc.accumulator(0.0, \"observation count\")\nval wrongPred \u003d testData.filter { point \u003d\u003e\n      obsCnt +\u003d 1\n      point.label !\u003d model.predict(point.features)\n}.count()\n\nval ratioWrong \u003d wrongPred / obsCnt.value\nprintln(s\"The model is wrong ${\"%.4f\".format(ratioWrong * 100)}% of the time.\")",
      "dateUpdated": "Jun 25, 2016 9:06:25 AM",
      "config": {
        "colWidth": 12.0,
        "graph": {
          "mode": "table",
          "height": 300.0,
          "optionOpen": false,
          "keys": [],
          "values": [],
          "groups": [],
          "scatter": {}
        },
        "enabled": true,
        "editorMode": "ace/mode/scala"
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466845533972_334037545",
      "id": "20160625-090533_1925982507",
      "result": {
        "code": "SUCCESS",
        "type": "TEXT",
        "msg": "obsCnt: org.apache.spark.Accumulator[Double] \u003d 0.0\nwrongPred: Long \u003d 11807\nratioWrong: Double \u003d 0.33896018143714296\nThe model is wrong 33.8960% of the time.\n"
      },
      "dateCreated": "Jun 25, 2016 9:05:33 AM",
      "dateStarted": "Jun 25, 2016 9:06:25 AM",
      "dateFinished": "Jun 25, 2016 9:06:27 AM",
      "status": "FINISHED",
      "progressUpdateIntervalMs": 500
    },
    {
      "config": {},
      "settings": {
        "params": {},
        "forms": {}
      },
      "jobName": "paragraph_1466845585438_1845239279",
      "id": "20160625-090625_970974537",
      "dateCreated": "Jun 25, 2016 9:06:25 AM",
      "status": "READY",
      "progressUpdateIntervalMs": 500
    }
  ],
  "name": "Demo TDS",
  "id": "2BEQV7PZ5",
  "angularObjects": {
    "2BRWX9MBQ:shared_process": [],
    "2BREA8CK9:shared_process": [],
    "2BPGDC9YC:shared_process": [],
    "2BNMW6A91:shared_process": [],
    "2BQ33S553:shared_process": [],
    "2BR64GGJQ:shared_process": [],
    "2BPQ9UFWP:shared_process": [],
    "2BPK6AQVR:shared_process": []
  },
  "config": {
    "looknfeel": "default"
  },
  "info": {}
}